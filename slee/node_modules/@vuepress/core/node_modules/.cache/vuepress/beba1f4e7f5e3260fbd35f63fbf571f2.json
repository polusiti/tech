{"remainingRequest":"/home/higuc/polusiti-tech/slee/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/higuc/polusiti-tech/slee/docs/.vuepress/components/Fantasy.vue?vue&type=style&index=0&id=68f2b227&lang=css","dependencies":[{"path":"/home/higuc/polusiti-tech/slee/docs/.vuepress/components/Fantasy.vue","mtime":1761327412131},{"path":"/home/higuc/polusiti-tech/slee/node_modules/css-loader/dist/cjs.js","mtime":1761329323866},{"path":"/home/higuc/polusiti-tech/slee/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1761329325641},{"path":"/home/higuc/polusiti-tech/slee/node_modules/postcss-loader/src/index.js","mtime":1761329323866},{"path":"/home/higuc/polusiti-tech/slee/node_modules/cache-loader/dist/cjs.js","mtime":1761329323494},{"path":"/home/higuc/polusiti-tech/slee/node_modules/vue-loader/lib/index.js","mtime":1761329324398}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5mYW50YXN5IHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHRvcDogMDsKICAgIGhlaWdodDogMTAwdmg7CiAgICB3aWR0aDogMTAwJTsKICAgIHotaW5kZXg6IC05Owp9CgouaGlkZGVuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCiNkaXNwbGF5IHsKICAgIG1hcmdpbjogYXV0bzsKfQoKLyog5Zu+54mH5aSn5bCPICovCi52ZG9pbmctaW5kZXgtY2xhc3MgLmhvbWUtd3JhcHBlciAuYmFubmVyIHsKICAgIG1hcmdpbi10b3A6IDAgIWltcG9ydGFudDsKICAgIGhlaWdodDogMTAwdmg7CiAgICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGZpeGVkICFpbXBvcnRhbnQ7Cn0KCi8qIOWbvueJh+S4remXtOeahOetvuWQjeWSjOagh+mimOS9jee9riAqLwouYmFubmVyLWNvbmVudCB7CiAgICBtYXJnaW4tdG9wOiAyM3ZoICFpbXBvcnRhbnQ7Cn0K"},{"version":3,"sources":["Fantasy.vue"],"names":[],"mappings":";AA4lBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Fantasy.vue","sourceRoot":"docs/.vuepress/components","sourcesContent":["<template>\n    <div class=\"fantasy\">\n        <canvas id=\"cvs\" class=\"hidden\" width=\"1980\" height=\"1080\"></canvas>\n        <canvas id=\"screenImage\" class=\"hidden\" width=\"234\" height=\"357\"></canvas>\n        <canvas id=\"rili\" class=\"hidden\" width=\"600\" height=\"600\"></canvas>\n        <canvas id=\"display\"></canvas>\n    </div>\n</template>\n\n<script>\nexport default {\n    mounted() {\n        // 只有一个 fantasy 元素，防止重复加载多个图片\n        if (document.getElementsByClassName(\"fantasy\")?.length === 1) {\n            // 如果使用 IndexBigImg.vue，则去掉该组件提供的时间罩\n            this.clearBannerColor();\n            // 如果是在首页注册该组件，则挂载到正确的位置\n            if (this.$attrs.index) {\n                this.mountedElement();\n            }\n            this.init();\n        }\n    },\n    methods: {\n        init() {\n            var cvs = document.getElementById(\"cvs\");\n            if (!cvs) {\n                return;\n            }\n            var ctx = cvs.getContext(\"2d\");\n\n            var display = document.getElementById(\"display\");\n            var displayCtx = display.getContext(\"2d\");\n\n            var screenImage = document.getElementById(\"screenImage\");\n            var screenImageCtx = screenImage.getContext(\"2d\");\n\n            var rili = document.getElementById(\"rili\");\n            var riliCtx = rili.getContext(\"2d\");\n\n            var songInfo = {};\n            var AllTimeBak = 0;\n            var NowBak = 0;\n            var DrawWarning = false;\n            var EnMonth = false;\n\n            // 出处：https://blog.csdn.net/u012601195/article/details/47860617\n            function drawRili() {\n                riliCtx.clearRect(0, 0, 600, 600);\n                var date = new Date();\n                var year = date.getYear();\n                var mouth = date.getMonth();\n                var today = date.getDate();\n                var week = date.getDay();\n\n                var cardSize = 40;\n\n                var array_three = [4, 6, 9, 11];\n                var array_threeone = [1, 3, 5, 7, 8, 10, 12];\n                var array_week = [\"SUN\", \"MON\", \"TUES\", \"WED\", \"THUR\", \"FRI\", \"SAT\"];\n\n                var firstDraw; //1号绘制位置\n                var wIdx = (today - 1) % 7;\n\n                if (week >= wIdx) {\n                    firstDraw = week - wIdx;\n                } else {\n                    firstDraw = week - wIdx + 7;\n                }\n\n                var dayIndex = 1;\n                var countDay = 30;\n\n                if (array_three.indexOf(mouth + 1) > -1) {\n                    countDay = 30;\n                } else if (array_threeone.indexOf(mouth + 1) > -1) {\n                    countDay = 31;\n                } else {\n                    if ((year % 4 == 0 && year % 100 != 0) || year % 400 == 0)\n                        countDay = 29;\n                    else countDay = 28;\n                }\n\n                var row = 6;\n                // if (7 - firstDraw + 7 * 4 < countDay) { //确定表格行数，防止日期绘制不全\n                //     row = 7;\n                //}\n\n                function drawTodaybg(i, j) {\n                    riliCtx.save();\n\n                    riliCtx.beginPath();\n                    riliCtx.strokeStyle = \"#900\";\n                    riliCtx.arc(\n                        45 + i * cardSize * 1.7 + cardSize / 1.18,\n                        50 + j * cardSize + cardSize / 2,\n                        cardSize / 2 - 10,\n                        -Math.PI,\n                        Math.PI * 1\n                    );\n                    riliCtx.stroke();\n                    riliCtx.closePath();\n\n                    riliCtx.beginPath();\n                    riliCtx.arc(\n                        45 + i * cardSize * 1.7 + cardSize / 1.18,\n                        50 + j * cardSize + cardSize / 2,\n                        cardSize / 2 - 9,\n                        -Math.PI,\n                        Math.PI * 0.9\n                    );\n                    riliCtx.stroke();\n                    riliCtx.closePath();\n\n                    riliCtx.beginPath();\n                    riliCtx.arc(\n                        45 + i * cardSize * 1.7 + cardSize / 1.18,\n                        50 + j * cardSize + cardSize / 2,\n                        cardSize / 2 - 8,\n                        -Math.PI,\n                        Math.PI * 0.8\n                    );\n                    riliCtx.stroke();\n                    riliCtx.closePath();\n\n                    riliCtx.beginPath();\n                    riliCtx.arc(\n                        45 + i * cardSize * 1.7 + cardSize / 1.18,\n                        50 + j * cardSize + cardSize / 2,\n                        cardSize / 2 - 7,\n                        -Math.PI,\n                        Math.PI * 0.7\n                    );\n                    riliCtx.stroke();\n                    riliCtx.closePath();\n\n                    riliCtx.beginPath();\n                    riliCtx.arc(\n                        45 + i * cardSize * 1.7 + cardSize / 1.18,\n                        50 + j * cardSize + cardSize / 2,\n                        cardSize / 2 - 6,\n                        -Math.PI,\n                        Math.PI * 0.6\n                    );\n                    riliCtx.stroke();\n                    riliCtx.closePath();\n\n                    riliCtx.restore();\n                }\n\n                var isNum = /^\\\\d+(\\\\d+)?$/;\n\n                function drawDate(txt, i, j) {\n                    riliCtx.textAlign = \"center\";\n                    riliCtx.fillStyle = \"rgb(69,68,84)\";\n                    riliCtx.font = cardSize / 1.5 + \"px Impact\";\n                    var yOffest = 3;\n\n                    if ((j == 0 || j == 6) && isNum.test(txt)) {\n                        riliCtx.fillStyle = \"#900\";\n                    }\n\n                    riliCtx.fillText(\n                        txt.toString(),\n                        45 + j * cardSize * 1.7 + cardSize / 1.18,\n                        50 + i * cardSize + (cardSize / 3) * 2 + yOffest\n                    );\n\n                    if (txt == today) {\n                        drawTodaybg(j, i);\n                    }\n                }\n\n                riliCtx.fillStyle = \"rgb(69,68,84)\";\n                riliCtx.font = \"900 26pt SimHei\";\n                riliCtx.textAlign = \"center\";\n                var monthCN = [\n                    \"一\",\n                    \"二\",\n                    \"三\",\n                    \"四\",\n                    \"五\",\n                    \"六\",\n                    \"七\",\n                    \"八\",\n                    \"九\",\n                    \"十\",\n                    \"十一\",\n                    \"十二\",\n                ];\n                var monthEN = [\n                    \" January\",\n                    \"February\",\n                    \"  March\",\n                    \"  April\",\n                    \"   May\",\n                    \"  June\",\n                    \"  July\",\n                    \" August\",\n                    \"September\",\n                    \" October\",\n                    \"November\",\n                    \" December\",\n                ];\n\n                if (EnMonth) {\n                    riliCtx.scale(1.1, 1);\n                    riliCtx.fillText(monthEN[mouth], 245, 32);\n                    riliCtx.resetTransform();\n                } else {\n                    riliCtx.scale(1.1, 1);\n                    riliCtx.fillText(monthCN[mouth] + \"月\", 260, 32);\n                    riliCtx.resetTransform();\n\n                    riliCtx.font = \"20pt SimHei\";\n                    riliCtx.textAlign = \"end\";\n                    riliCtx.fillText(today + \"日\", 520, 38);\n                }\n\n                for (var i = 0; i < row; i++) {\n                    for (var j = 0; j < 7; j++) {\n                        riliCtx.strokeRect(\n                            45 + j * cardSize * 1.7,\n                            50 + i * cardSize,\n                            cardSize * 1.7,\n                            cardSize\n                        );\n                    }\n                }\n\n                dayIndex = 1;\n\n                for (var i = 0; i < row; i++) {\n                    //开始绘制日期数\n                    for (var j = 0; j < 7; j++) {\n                        if (i == 0) {\n                            //表格第一行绘制星期\n                            drawDate(array_week[j], i, j);\n                            continue;\n                        }\n\n                        if (i == 1 && j < firstDraw) {\n                            //确定1号绘制位置\n                            continue;\n                        }\n\n                        if (dayIndex > countDay) {\n                            //只绘制月份的天数\n                            break;\n                        }\n\n                        drawDate(dayIndex++, i, j);\n                    }\n                }\n            }\n\n            var riliInterval = setInterval(drawRili, 3600000);\n            drawRili();\n\n            // Canvas奇妙的剪切蒙版实现\n            var screenMask = new Image();\n            screenMask.src = this.$withBase('/fantasy/Screenmask.png');\n\n            var screen = new Image();\n            screen.src = this.$withBase('/fantasy/screen.png');\n\n            var iv = setInterval(() => {\n                if (screen.complete && screenMask.complete) {\n                    // 可以切换图片的位置，也可以换成自己的图片\n                    screenImageCtx.drawImage(screen, -300, -50, 1280, 720);\n                    screenImageCtx.globalCompositeOperation = \"destination-atop\";\n                    screenImageCtx.drawImage(screenMask, 0, 0);\n                    screenImageCtx.globalCompositeOperation = \"source-over\";\n                    clearInterval(iv);\n                }\n            }, 14);\n\n            // 奇妙的屏幕大小自适应\n            window.onresize = function () {\n                display.width = window.innerWidth;\n                if (window.innerWidth / window.innerHeight > 1.8333333333333) {\n                    display.height = (window.innerWidth / 1980) * 1080;\n                    // window.scrollTo(0, (window.innerHeight - 123) / 16);\n                } else {\n                    display.height = window.innerHeight;\n                }\n            };\n\n            window.onresize();\n\n            // 加载图片\n            var bg = new Image();\n            bg.src = this.$withBase('/fantasy/bg.png');\n\n            var mask = new Image();\n            mask.src = this.$withBase('/fantasy/mask.png');\n\n            var light = new Image();\n            light.src = this.$withBase('/fantasy/light.png');\n\n            var caidai = new Image();\n            caidai.src = this.$withBase('/fantasy/caidai.png');\n\n            // /fantasy/Screenmask.png\n            var two = new Image();\n            two.src = this.$withBase('/fantasy/22.png');\n\n            var screenLight = new Image();\n            screenLight.src = this.$withBase('/fantasy/screenLight.png');\n\n            var phoneLight = new Image();\n            phoneLight.src = this.$withBase('/fantasy/phoneLight.png');\n\n            var phoneText = JSON.parse(\n                '[{\"time\":0,\"text\":\"凌晨啦!\"},{\"time\":6,\"text\":\"早上好!\"},{\"time\":8,\"text\":\"上午好!\"},{\"time\":11,\"text\":\"你吃了吗\"},{\"time\":13,\"text\":\"下午好鸭!\"},{\"time\":16,\"text\":\"傍晚咯!\"},{\"time\":19,\"text\":\"晚安!\"}]'\n            );\n\n            var noRili = false;\n            var updateSongInfoHandler = -1;\n\n            var data = new Array(128);\n            var animData = new Array(128);\n            var SoundPlaying = false;\n\n            // 奇妙的初始化\n            for (var i = 0; i < 128; i++) {\n                data[i] = animData[i] = 0;\n            }\n\n            // 奇妙的Normalize\n            var peakValue = 1;\n            if (window.wallpaperRegisterAudioListener) {\n                window.wallpaperRegisterAudioListener(function (audioData) {\n                    var max = 0;\n\n                    for (var i = 0; i < 128; i++) {\n                        if (audioData[i] > max) max = audioData[i];\n                    }\n\n                    peakValue = peakValue * 0.99 + max * 0.01;\n\n                    for (i = 0; i < 64; i++) {\n                        data[63 - i] = audioData[i] / peakValue;\n                    }\n\n                    for (i = 0; i < 64; i++) {\n                        data[127 - i] = audioData[127 - i];\n                    }\n                });\n            } else {\n                var iva;\n                let audio = document.getElementsByClassName(\"aplayer-button\")[0];\n                if (audio) {\n                    audio.onclick = () => {\n                        let play = document.getElementsByClassName(\"aplayer-play\")[0];\n                        if (play) {\n                            iva = setInterval(() => {\n                                for (i = 0; i < 64; i++) {\n                                    peakValue = peakValue * 0.99 + 1 * 0.01;\n                                    data[63 - i] =\n                                        ((Math.random() * 0.4) / peakValue) * Math.random();\n                                }\n                                for (i = 0; i < 64; i++) {\n                                    data[127 - i] = Math.random() * 0.2 * Math.random();\n                                }\n                                // for (var i = 0; i < 128; i++) {\n                                //     data[i] = Math.random();\n                                // }\n                            }, 130);\n                        } else {\n                            clearInterval(iva);\n                            for (var i = 0; i < 128; i++) {\n                                data[i] = animData[i] = 0;\n                            }\n                        }\n                    };\n                }\n            }\n\n            // ....\n            function min(a, b) {\n                return a > b ? b : a;\n            }\n\n            function max(a, b) {\n                return a > b ? a : b;\n            }\n\n            // 奇妙的颜色变化\n            var targetColor = {r: 80, g: 120, b: 169};\n            var currentColor = {r: 80, g: 120, b: 169};\n            var lightColor = {r: 0, g: 34, b: 77, a: 0};\n\n            function colorToRgb(color) {\n                return (\n                    \"rgb(\" +\n                    color.r.toString() +\n                    \",\" +\n                    color.g.toString() +\n                    \",\" +\n                    color.b.toString() +\n                    \")\"\n                );\n            }\n\n            function colorToRgba(colorWithA) {\n                return (\n                    \"rgba(\" +\n                    colorWithA.r.toString() +\n                    \",\" +\n                    colorWithA.g.toString() +\n                    \",\" +\n                    colorWithA.b.toString() +\n                    \",\" +\n                    colorWithA.a.toString() +\n                    \")\"\n                );\n            }\n\n            var night = false;\n            var debug = false;\n\n            // Canvas的奇妙冒险!\n            function render() {\n                for (var i = 0; i < 128; i++) {\n                    animData[i] += (data[i] - animData[i]) * 0.3;\n                    animData[i] = min(animData[i], 1);\n                }\n\n                currentColor.r += (targetColor.r - currentColor.r) * 0.01;\n                currentColor.r = min(currentColor.r, 255);\n                currentColor.r = max(currentColor.r, 0);\n\n                currentColor.g += (targetColor.g - currentColor.g) * 0.01;\n                currentColor.g = min(currentColor.g, 255);\n                currentColor.g = max(currentColor.g, 0);\n\n                currentColor.b += (targetColor.b - currentColor.b) * 0.01;\n                currentColor.b = min(currentColor.b, 255);\n                currentColor.b = max(currentColor.b, 0);\n\n                ctx.clearRect(0, 0, 1980, 1080);\n                ctx.drawImage(bg, 0, 0);\n                ctx.drawImage(mask, 954, 99);\n\n                ctx.fillStyle = \"#97adbb\"; // 时间的颜色\n                ctx.font = \"32pt Impact\";\n\n                ctx.transform(1, 2.05 * (Math.PI / 180), 0, 1, 0, 0);\n\n                var time = new Date();\n                ctx.fillText(\n                    (time.getHours() < 10 ? \"0\" : \"\") +\n                    time.getHours().toString() +\n                    \":\" +\n                    (time.getMinutes() < 10 ? \"0\" : \"\") +\n                    time.getMinutes() +\n                    \":\" +\n                    (time.getSeconds() < 10 ? \"0\" : \"\") +\n                    time.getSeconds().toString(),\n                    725,\n                    318\n                );\n                ctx.resetTransform();\n\n                // 日历本\n                ctx.transform(0.9645, 0, 0 * (Math.PI / 180), 0.96, 967, 100);\n                ctx.rotate(6 * (Math.PI / 180));\n\n                if (!noRili) {\n                    ctx.drawImage(rili, 0, 0);\n\n                    ctx.resetTransform();\n\n                    ctx.transform(0.9645, 0, 9 * (Math.PI / 180), 1, 825, 160);\n                    ctx.rotate(7 * (Math.PI / 180));\n                }\n\n                targetColor = {r: 80, g: 120, b: 169};\n\n                if (night) {\n                    targetColor = {r: 255, g: 75, b: 80};\n                }\n\n                if (!noRili) {\n                    ctx.fillStyle = \"rgba(0,0,0,0.5)\";\n                    ctx.fillRect(-10, 320, 650, 2);\n                }\n\n                ctx.fillStyle = colorToRgb(currentColor);\n\n                if (!noRili) {\n                    for (var i = 32; i < 95; i++)\n                        ctx.fillRect(\n                            10 * (i - 32),\n                            20 + (300 - 300 * animData[i]),\n                            4,\n                            300 * animData[i]\n                        );\n                } else\n                    for (var i = 32; i < 95; i++)\n                        ctx.fillRect(\n                            40 + 7.5 * (i - 32),\n                            30 + (300 - 300 * animData[i]),\n                            4,\n                            300 * animData[i]\n                        );\n\n                ctx.resetTransform();\n\n                ctx.globalCompositeOperation = \"overlay\";\n                ctx.drawImage(light, 971, 197);\n                ctx.globalCompositeOperation = \"source-over\";\n\n                ctx.drawImage(caidai, 949, 25);\n                ctx.drawImage(two, 1319, 345);\n\n                // 夜间光照\n                if (night && lightColor.a < 0.7) {\n                    lightColor.a += 0.005;\n                    lightColor.a = min(lightColor.a, 0.7);\n                } else if (!night) {\n                    lightColor.a -= 0.005;\n                    lightColor.a = max(lightColor.a, 0.0);\n                }\n\n                if (lightColor.a > 0) {\n                    ctx.globalCompositeOperation = \"hard-light\";\n                    ctx.fillStyle = colorToRgba(lightColor);\n                    ctx.fillRect(0, 0, 1980, 1080);\n                    ctx.globalCompositeOperation = \"source-over\";\n\n                    ctx.globalAlpha = lightColor.a / 0.7;\n                    ctx.drawImage(phoneLight, 860, 437);\n                    ctx.globalAlpha = 1;\n                }\n\n                // 屏幕\n                ctx.drawImage(screenImage, 0, 0);\n                if (lightColor.a > 0) {\n                    ctx.globalAlpha = lightColor.a / 0.7;\n                    ctx.drawImage(screenLight, 0, 0);\n                    ctx.globalAlpha = 1;\n                }\n\n                night = true;\n                var greeting = \"凌晨啦!\";\n\n                phoneText.forEach((v) => {\n                    if (time.getHours() >= v.time) {\n                        greeting = v.text;\n                    }\n                });\n\n                if (time.getHours() >= 6 && time.getHours() <= 18) {\n                    night = false;\n                }\n\n                night = debug ? !night : night;\n\n                // 手机\n                ctx.fillStyle = \"#000\";\n                ctx.font = \"31.02pt SimHei\";\n\n                ctx.transform(\n                    1.0911,\n                    -35 * (Math.PI / 180),\n                    0,\n                    0.5868,\n                    1132.94,\n                    564.07\n                );\n                ctx.rotate(56.5 * (Math.PI / 180));\n                ctx.textAlign = \"center\";\n                ctx.fillStyle = \"#fff\";\n                ctx.fillText(greeting, 135, 100);\n                ctx.textAlign = \"start\";\n                ctx.resetTransform();\n\n                displayCtx.drawImage(cvs, 0, 0, display.width, display.height);\n                window.requestAnimationFrame(render);\n            }\n\n            window.requestAnimationFrame(render);\n        },\n        // 针对首页挂载元素\n        mountedElement() {\n            let fantasy = document.getElementsByClassName(\"fantasy\")[0];\n            let banner = document.getElementsByClassName(\"banner\")[0];\n            // 去掉黑色栅格背景\n            banner.style.background = \"none\";\n            fantasy && banner && banner.appendChild(fantasy);\n        },\n        clearBannerColor() {\n            let bannerColor = document.getElementsByClassName(\"banner-color\")[0];\n            if (bannerColor) {\n                bannerColor.parentNode.removeChild(bannerColor);\n            }\n        },\n    },\n};\n</script>\n\n<style>\n.fantasy {\n    position: fixed;\n    top: 0;\n    height: 100vh;\n    width: 100%;\n    z-index: -9;\n}\n\n.hidden {\n    display: none;\n}\n\n#display {\n    margin: auto;\n}\n\n/* 图片大小 */\n.vdoing-index-class .home-wrapper .banner {\n    margin-top: 0 !important;\n    height: 100vh;\n    background-attachment: fixed !important;\n}\n\n/* 图片中间的签名和标题位置 */\n.banner-conent {\n    margin-top: 23vh !important;\n}\n</style>\n</resource>"]}]}