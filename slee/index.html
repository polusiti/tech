<!DOCTYPE html>
<html lang="ja-JP">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slee | Interactive Visual Experience</title>
  <meta name="description" content="Experience interactive canvas animations and visual effects">
  <base href="/slee/">
  <link rel="icon" href="icon/logo.ico">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_3114978_qe0b39no76.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@vuepress/theme-default@1.9.5/lib/styles/index.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">

  <style>
    /* Âü∫Êú¨„Çπ„Çø„Ç§„É´ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      background: #f0f0f0;
      min-height: 100vh;
      color: #004050;
    }

    .banner {
      background: none !important;
      position: relative;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 3.6rem;
      background-color: rgba(255, 255, 255, 0.9);
      backdrop-filter: saturate(180%) blur(20px);
      border-bottom: 1px solid rgba(0,0,0,0.1);
      z-index: 1000;
      display: flex;
      align-items: center;
      padding: 0 1rem;
    }

    .navbar-brand {
      font-size: 1.5rem;
      font-weight: bold;
      color: #004050;
      text-decoration: none;
    }

    .navbar-nav {
      margin-left: auto;
      display: flex;
      list-style: none;
    }

    .navbar-nav li {
      margin-left: 1.5rem;
    }

    .navbar-nav a {
      color: #004050;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
    }

    .navbar-nav a:hover {
      color: #11A8CD;
    }

    .main-content {
      margin-top: 3.6rem;
      min-height: calc(100vh - 3.6rem);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 2rem;
    }

    .hero {
      text-align: center;
      margin-bottom: 3rem;
      position: relative;
    }

    .hero img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      margin-bottom: 1rem;
    }

    .hero h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: #004050;
    }

    .hero p {
      font-size: 1.2rem;
      color: #666;
      line-height: 1.6;
    }

    .search-container {
      margin-bottom: 2rem;
      text-align: center;
    }

    .search-box {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .search-box input {
      padding: 0.8rem 1rem;
      border: 2px solid #e1e5e9;
      border-radius: 25px 0 0 25px;
      outline: none;
      width: 300px;
      font-size: 1rem;
    }

    .search-box button {
      padding: 0.8rem 1.5rem;
      border: none;
      background: #11A8CD;
      color: white;
      border-radius: 0 25px 25px 0;
      cursor: pointer;
      outline: none;
    }

    .search-box button:hover {
      background: #0d8bb3;
    }

    .tip-container {
      text-align: center;
      margin: 2rem 0;
      min-height: 2rem;
    }

    .global-tip {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 8px;
      padding: 1rem 1.5rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin: 1rem auto;
      max-width: 600px;
      opacity: 0;
      transform: translateY(-10px);
      transition: all 0.3s ease;
    }

    .global-tip.show {
      opacity: 1;
      transform: translateY(0);
    }

    .global-tip.info { border-left: 4px solid #11A8CD; }
    .global-tip.success { border-left: 4px solid #52c41a; }
    .global-tip.warning { border-left: 4px solid #faad14; }
    .global-tip.error { border-left: 4px solid #f5222d; }

    .tip-time {
      font-size: 0.8rem;
      color: #666;
      font-family: monospace;
    }

    .content-section {
      max-width: 800px;
      margin: 0 auto 3rem auto;
    }

    .content-section h2 {
      color: #004050;
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .content-section p {
      line-height: 1.7;
      color: #666;
      margin-bottom: 1rem;
    }

    .content-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    .content-card {
      background: white;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .content-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0,0,0,0.15);
    }

    .content-card h3 {
      color: #004050;
      margin-bottom: 0.5rem;
    }

    .content-card p {
      color: #666;
      line-height: 1.6;
    }

    /* ËÉåÊôØCanvas„ÅÆ stacking context Ë™øÊï¥ */
    .global-ui { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; }
    .global-ui .fantasy { position: fixed; top:0; width:100%; height:100vh; z-index:-9; pointer-events:none; }
    .fantasy canvas { width:100%; height:100%; }
    .banner-conent { margin-top:23vh !important; padding-top:0 !important; }

    .hidden {
      display: none;
    }

    .fantasy-loading {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #004050;
      font-size: 1.2rem;
      z-index: 10;
    }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      color: #666;
      background: rgba(255,255,255,0.8);
    }

    /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥ */
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 2rem;
      }

      .navbar {
        padding: 0 0.5rem;
      }

      .navbar-brand {
        font-size: 1.2rem;
      }

      .navbar-nav li {
        margin-left: 1rem;
      }

      .search-box input {
        width: 200px;
      }

      .main-content {
        padding: 1rem;
      }

      .content-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 640px) {
      .navbar-nav {
        display: none;
      }

      .fantasy {
        display: none;
      }

      .hero {
        margin-bottom: 2rem;
      }
    }
  </style>
</head>

<body>
  <nav class="navbar">
    <a href="/" class="navbar-brand">Slee</a>
    <ul class="navbar-nav">
      <li><a href="#home">Home</a></li>
      <li><a href="#experience">Experience</a></li>
      <li><a href="#gallery">Gallery</a></li>
      <li><a href="#about">About</a></li>
    </ul>
  </nav>

  <div class="main-content">
    <div class="banner" id="home">
      <div class="banner-conent">
        <div class="hero">
          <h1>Slee</h1>
          <p>Interactive Visual Experience</p>
        </div>
      </div>
    </div>

    <div class="search-container">
      <div class="search-box">
        <input type="text" id="siteSearch" placeholder="Search content...">
        <button onclick="performSearch()">Search</button>
      </div>
    </div>

    <div class="tip-container">
      <div id="globalTip" class="global-tip">
        <div class="icon iconfont icon-info"></div>
        <div class="tip-content"></div>
        <div class="tip-time"></div>
      </div>
    </div>

    <div id="experience" class="content-section">
      <h2>Interactive Experience</h2>
      <p>Welcome to Slee, an interactive canvas-based visual experience. Our system combines real-time rendering, dynamic effects, and responsive design to create an immersive digital environment.</p>
    </div>

    <div class="content-grid">
      <div class="content-card">
        <h3>Dynamic Rendering</h3>
        <p>Real-time canvas animations with smooth transitions and effects.</p>
      </div>
      <div class="content-card">
        <h3>Responsive Design</h3>
        <p>Adapts seamlessly to different screen sizes and devices.</p>
      </div>
      <div class="content-card">
        <h3>Interactive Elements</h3>
        <p>Dynamic visual feedback based on time and user interaction.</p>
      </div>
    </div>

    <div id="gallery" class="content-section">
      <h2>Visual Gallery</h2>
      <p>Experience a carefully crafted visual journey with dynamic backgrounds, animated elements, and time-based effects.</p>
    </div>

    <div id="about" class="content-section">
      <h2>About Slee</h2>
      <p>Slee represents the intersection of art and technology, creating an interactive visual experience that responds to time, environment, and user presence.</p>
    </div>
  </div>

  <footer>
    <p>&copy; 2024 Slee. All rights reserved.</p>
  </footer>

  <div class="global-ui">
    <div class="fantasy">
      <canvas id="cvs" width="1980" height="1080" class="hidden"></canvas>
      <canvas id="screenImage" width="234" height="357" class="hidden"></canvas>
      <canvas id="rili" width="600" height="600" class="hidden"></canvas>
      <canvas id="display"></canvas>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
  (function() {
     // 1) .fantasy „Çí .banner ÂÜÖ„Å∏Êó©ÊúüÁßªÂãïÔºàÂàùÊúü„É¨„Ç§„Ç¢„Ç¶„Éà„Ç∫„É¨Èò≤Ê≠¢Ôºâ
     document.addEventListener('DOMContentLoaded', function() {
       const f = document.querySelector('.fantasy');
       const b = document.querySelector('.banner');
       if (f && b && !b.contains(f)) b.appendChild(f);
       initFantasy();
       initSearch();
       setTimeout(showGlobalTip, 5000);
       console.log('Init: fantasy moved, search ready, tip scheduled');
     });

     // 2) R2ÂÑ™ÂÖà + „É≠„Éº„Ç´„É´fallback „ÅÆÁîªÂÉèÂÆöÁæ©
     const R2 = 'https://pub-d59d6e46c3154423956f648f8df909ae.r2.dev';
     const fantasySources = {
       main:        [R2 + '/22.png',          'fantasy/22.png'],
       bg:          [R2 + '/bg.png',          'fantasy/bg.png'],
       caidai:      [R2 + '/caidai.png',      'fantasy/caidai.png'],
       light:       [R2 + '/light.png',       'fantasy/light.png'],
       mask:        [R2 + '/mask.png',        'fantasy/mask.png'],
       phoneLight:  [R2 + '/phoneLight.png',  'fantasy/phoneLight.png'],
       screen:      [R2 + '/screen.png',      'fantasy/screen.png'],
       screenborder:[R2 + '/screenborder.png','fantasy/screenborder.png'],
       screenLight: [R2 + '/screenLight.png', 'fantasy/screenLight.png'],
       screenMask:  [R2 + '/Screenmask.png',  'fantasy/Screenmask.png'] // S Â§ßÊñáÂ≠ó
     };

     function preloadImages(sources, done) {
       const images = {};
       const keys = Object.keys(sources);
       let loaded = 0;
       function onOne() {
         loaded++;
         if (loaded === keys.length) done(images);
       }
       console.log('Loading fantasy images (R2-first with fallback)...');
       keys.forEach(k => {
         const img = new Image();
         images[k] = img;
         img.crossOrigin = 'anonymous';
         let i = 0;
         const tryNext = () => {
           if (i >= sources[k].length) {
             console.error('All sources failed for', k);
             onOne();
             return;
           }
           const url = sources[k][i++];
           img.onload = () => { console.log('Loaded', k, 'from', url); onOne(); };
           img.onerror = () => { console.warn('Failed', k, 'at', url, '-> try next'); tryNext(); };
           img.src = url;
         };
         tryNext();
       });
     }

     // 3) Ê§úÁ¥¢/TipÔºà„Åù„ÅÆ„Åæ„ÅæÔºâ
     function initSearch() {
       const searchInput = document.getElementById('siteSearch');
       if (!searchInput) return;
       searchInput.addEventListener('input', function(e) {
         const q = e.target.value.toLowerCase();
         if (q.length > 2) highlightText(q); else removeHighlights();
       });
       searchInput.addEventListener('keypress', function(e) {
         if (e.key === 'Enter') {
           const q = e.target.value.toLowerCase();
           if (q.length > 0) performSearch(q);
         }
       });
     }
     function highlightText(q) {
       removeHighlights();
       const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT, null, false);
       let node;
       while ((node = walker.nextNode())) {
         const p = node.parentNode.tagName;
         if (p === 'SCRIPT' || p === 'STYLE') continue;
         const value = node.nodeValue;
         if (value.toLowerCase().includes(q)) {
           const span = document.createElement('span');
           span.innerHTML = value.replace(new RegExp('(' + q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&') + ')','gi'),
             '<mark style="background:yellow;padding:2px;">$1</mark>');
           node.parentNode.replaceChild(span, node);
         }
       }
     }
     function removeHighlights() {
       document.querySelectorAll('mark').forEach(mark => {
         const parent = mark.parentNode;
         parent.replaceChild(document.createTextNode(mark.textContent), mark);
         parent.normalize();
       });
     }
     function performSearch(query) {
       window.open('https://www.google.com/search?q=site:tech.allfrom0.top/slee ' + encodeURIComponent(query),
   '_blank');
     }
     function showGlobalTip() {
       const d = new Date();
       const h = d.getHours();
       const mm = String(d.getMinutes()).padStart(2,'0');
       const ss = String(d.getSeconds()).padStart(2,'0');
       let msg = '', type = 'info', icon = 'icon-info';
       if (h >= 6 && h < 9)       msg = `„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô~~ÔºåÁèæÂú® ${h}:${mm}:${ss}ÔºåÊúù„Åî„ÅØ„Çì„ÇíÈ£ü„Åπ„Åæ„Åó„Åü„ÅãÔºüüçî`;
       else if (h < 12)           msg = `„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô~~ÔºåÁèæÂú®
   ${h}:${mm}:${ss}Ôºå„Çµ„Éú„Çâ„Å™„ÅÑ„Çà„ÅÜ„Å´Ê∞ó„Çí„Å§„Åë„Å¶„Åè„Å†„Åï„ÅÑüêü~~`;
       else if (h < 13)           { msg = `„Åì„Çì„Å´„Å°„ÅØ~~ÔºåÁèæÂú® ${h}:${mm}:${ss}Ôºå„ÅäÊòº„ÅÆ„ÅîÈ£Ø„ÅÆÊôÇÈñì„Åß„Åôüçö~~`;
   type='success'; icon='icon-dagouyouquan'; }
       else if (h < 14)           msg = `„Åì„Çì„Å´„Å°„ÅØ~~ÔºåÁèæÂú® ${h}:${mm}:${ss}ÔºåÂøô„Åó„ÅÑÂçàÂæå„ÇÇÈÅ©Â∫¶„Å´‰ºëÊÜ©„Åó„Å¶„Åè„Å†„Åï„ÅÑüò¥~~`;
       else if (h < 17)           msg = `„Åì„Çì„Å´„Å°„ÅØ~~ÔºåÁèæÂú® ${h}:${mm}:${ss}ÔºåÂçàÂæå„ÇÇÈ†ëÂºµ„Å£„Å¶„Åè„Å†„Åï„ÅÑüêü~~`;
       else if (h < 19)           { msg = `Â§ïÊñπ„Å´„Å™„Çä„Åæ„Åó„Åü~~ÔºåÁèæÂú® ${h}:${mm}:${ss}ÔºåÂ§ïÈ£ü„ÅÆÊ∫ñÂÇô„Çí„Åó„Åæ„Åó„Çá„ÅÜü•óüçñ~~`;
   type='warning'; icon='icon-gantanhao'; }
       else if (h < 20)           { msg = `„Åì„Çì„Å∞„Çì„ÅØ~~ÔºåÁèæÂú®
   ${h}:${mm}:${ss}Ôºå‰∏ÄÊó•„ÅäÁñ≤„ÇåÊßò„Åß„Åó„ÅüÔºåÈÅãÂãï„ÇÇ„Åó„Åæ„Åó„Çá„ÅÜüèÉ‚Äç‚ôÇÔ∏è~~`; type='success'; icon='icon-dagouyouquan'; }
       else if (h < 23)           msg = `„Åì„Çì„Å∞„Çì„ÅØ~~ÔºåÁèæÂú® ${h}:${mm}:${ss}ÔºåÂ§ú„ÇÇ„Åì„Å£„Åù„ÇäÂãâÂº∑„Åó„Åæ„Åó„Çá„ÅÜüíØ~~`;
       else if (h < 24)           { msg = `„Åì„Çì„Å∞„Çì„ÅØ~~ÔºåÁèæÂú®
   ${h}:${mm}:${ss}Ôºå„Åù„Çç„Åù„Çç„ÅäÈ¢®ÂëÇ„Å´ÂÖ•„Å£„Å¶ÂØù„Åæ„Åó„Çá„ÅÜüõÄü•±üò™~~`; type='warning'; icon='icon-gantanhao'; }
       else                       { msg = `Â§úÊõ¥„Åã„Åó„Åó„Å™„ÅÑ„Åß~~ÔºåÁèæÂú®
   ${h}:${mm}:${ss}ÔºåÊó©„ÅèÂØù„Å¶ÔºåÊúùÊó•„Çí‰∏ÄÁ∑í„Å´Ê•Ω„Åó„Åø„Åæ„Åó„Çá„ÅÜ~~üòáüõè`; type='warning'; icon='icon-gantanhao'; }
       const tip = document.getElementById('globalTip');
       if (!tip) return;
       tip.className = 'global-tip ' + type;
       tip.querySelector('.icon').className = 'icon iconfont ' + icon;
       tip.querySelector('.tip-content').textContent = msg;
       tip.querySelector('.tip-time').textContent = `${h}:${mm}:${ss}`;
       setTimeout(()=>tip.classList.add('show'), 100);
       setTimeout(()=>tip.classList.remove('show'), 4000);
     }

     // 4) Fantasy Êú¨‰Ωì
     function initFantasy() {
       const cvs = document.getElementById('cvs');
       const display = document.getElementById('display');
       const rili = document.getElementById('rili');
       const screenImage = document.getElementById('screenImage');
       if (!cvs || !display || !rili || !screenImage) return;

       const ctx = cvs.getContext('2d');
       const displayCtx = display.getContext('2d');
       const riliCtx = rili.getContext('2d');
       const screenImageCtx = screenImage.getContext('2d');

       // equalizer data
       const data = new Array(128).fill(0);
       const animData = new Array(128).fill(0);

       let targetColor = {r:80, g:120, b:169};
       let currentColor = {r:80, g:120, b:169};
       let lightColor = {r:0, g:34, b:77, a:0};
       let night = false;

       const phoneText = [
         {time:0,  text:'ÂáåÊô®Âï¶!'},
         {time:6,  text:'Êó©‰∏äÂ•Ω!'},
         {time:8,  text:'‰∏äÂçàÂ•Ω!'},
         {time:11, text:'‰Ω†ÂêÉ‰∫ÜÂêó'},
         {time:13, text:'‰∏ãÂçàÂ•ΩÈ∏≠!'},
         {time:16, text:'ÂÇçÊôöÂíØ!'},
         {time:19, text:'ÊôöÂÆâ!'}
       ];

       function min(a,b){ return a>b?b:a; }
       function max(a,b){ return a>b?a:b; }
       function toRgb(c){ return `rgb(${c.r},${c.g},${c.b})`; }
       function toRgba(c){ return `rgba(${c.r},${c.g},${c.b},${c.a})`; }

       // „Ç´„É¨„É≥„ÉÄ„ÉºÔºàÂéüÊú¨Ê∫ñÊã†„ÉªÁ∞°Áï•Ôºâ
       function drawRili() {
         riliCtx.clearRect(0,0,600,600);
         const date=new Date();
         const year=date.getYear();
         const mouth=date.getMonth();
         const today=date.getDate();
         const week=date.getDay();
         const cardSize=40;
         const array_three=[4,6,9,11];
         const array_threeone=[1,3,5,7,8,10,12];
         const array_week=['SUN','MON','TUES','WED','THUR','FRI','SAT'];
         let firstDraw, wIdx=(today-1)%7;
         firstDraw = week>=wIdx ? week-wIdx : week-wIdx+7;
         let countDay=30;
         if (array_three.indexOf(mouth+1)>-1) countDay=30;
         else if (array_threeone.indexOf(mouth+1)>-1) countDay=31;
         else countDay = ((year%4==0 && year%100!=0) || year%400==0)?29:28;
         const row=6;
         function drawTodaybg(i,j){
           riliCtx.save();
           riliCtx.beginPath();
           riliCtx.strokeStyle='#ff4444';
           riliCtx.lineWidth=2;
           riliCtx.arc(45+j*cardSize*1.7+cardSize/1.18, 50+i*cardSize+cardSize/2, cardSize/2-8, -Math.PI, Math.PI);
           riliCtx.stroke();
           riliCtx.fillStyle='rgba(255,68,68,0.1)';
           riliCtx.fill();
           riliCtx.closePath();
           riliCtx.restore();
         }
         function drawDate(txt,i,j){
           riliCtx.textAlign='center';
           riliCtx.fillStyle='rgb(69,68,84)';
           riliCtx.font=cardSize/1.5+'px Impact';
           if ((j==0||j==6) && /^\d+(\d+)?$/.test(txt)) riliCtx.fillStyle='#900';
           riliCtx.fillText(String(txt), 45+j*cardSize*1.7+cardSize/1.18, 50+i*cardSize+(cardSize/3)*2+3);
           if (txt===today) drawTodaybg(i,j);
         }
         riliCtx.fillStyle='rgb(69,68,84)';
         riliCtx.font='900 26pt SimHei';
         riliCtx.textAlign='center';
         const monthCN=['‰∏Ä','‰∫å','‰∏â','Âõõ','‰∫î','ÂÖ≠','‰∏É','ÂÖ´','‰πù','ÂçÅ','ÂçÅ‰∏Ä','ÂçÅ‰∫å'];
         riliCtx.scale(1.1,1);
         riliCtx.fillText(monthCN[mouth]+'Êúà', 260, 32);
         riliCtx.resetTransform();
         riliCtx.font='bold 20pt SimHei';
         riliCtx.fillStyle='#ff4444';
         riliCtx.textAlign='end';
         riliCtx.fillText(today+'Êó•', 520, 38);
         for (let i=0;i<row;i++){
           for (let j=0;j<7;j++){
             riliCtx.strokeRect(45+j*cardSize*1.7, 50+i*cardSize, cardSize*1.7, cardSize);
           }
         }
         let dayIndex=1;
         for (let i=0;i<row;i++){
           for (let j=0;j<7;j++){
             if (i==0){ drawDate(array_week[j],i,j); continue; }
             if (i==1 && j<firstDraw) continue;
             if (dayIndex>countDay) break;
             drawDate(dayIndex,i,j); dayIndex++;
           }
         }
       }

       function resizeLikeOriginal() {
         display.width = window.innerWidth;
         if (window.innerWidth / window.innerHeight > 1.8333333333333) {
           display.height = (window.innerWidth / 1980) * 1080;
         } else {
           display.height = window.innerHeight;
         }
       }

       // ÁîªÂÉè„Éó„É™„É≠„Éº„Éâ ‚Üí screenÂêàÊàê ‚Üí ÊèèÁîªÈñãÂßã
       preloadImages(fantasySources, (images) => {
         // „Çπ„ÇØ„É™„Éº„É≥ÂêàÊàêÔºàscreen + Screenmask ‚Üí screenImageÔºâ
         const iv = setInterval(() => {
           const screen = images.screen, screenMask = images.screenMask;
           if (screen && screen.complete && screenMask && screenMask.complete) {
             screenImageCtx.clearRect(0,0,screenImage.width,screenImage.height);
             screenImageCtx.drawImage(screen, -300, -50, 1280, 720);
             screenImageCtx.globalCompositeOperation = 'destination-atop';
             screenImageCtx.drawImage(screenMask, 0, 0);
             screenImageCtx.globalCompositeOperation = 'source-over';
             clearInterval(iv);
             console.log('Screen composed to screenImage');
           }
         }, 16);

         // Á≠âÂåñÂô®„ÉÄ„Éü„ÉºÔºàAPlayer„ÅåÁÑ°„ÅÑÂ†¥Âêà„ÅÆË¶ñË¶öÂäπÊûúÔºâ
         let iva;
         const playBtn = document.getElementsByClassName('aplayer-button')[0];
         if (playBtn) {
           playBtn.onclick = () => {
             const playing = document.getElementsByClassName('aplayer-play')[0];
             if (playing) {
               iva = setInterval(() => {
                 for (let i=0;i<64;i++){
                   data[63-i] = Math.random()*0.4;
                 }
                 for (let i=0;i<64;i++){
                   data[127-i] = Math.random()*0.2;
                 }
               }, 130);
             } else {
               clearInterval(iva);
               for (let i=0;i<128;i++){ data[i]=animData[i]=0; }
             }
           };
         } else {
           // ‰Ωï„ÇÇÁÑ°„ÅÑÂ†¥Âêà„ÅØÂ∏∏ÊôÇ„ÉÄ„Éü„Éº
           iva = setInterval(() => {
             for (let i=0;i<64;i++){
               data[63-i] = Math.random()*0.4;
             }
             for (let i=0;i<64;i++){
               data[127-i] = Math.random()*0.2;
             }
           }, 130);
         }

         function render() {
           for (let i=0;i<128;i++){
             animData[i] += (data[i] - animData[i]) * 0.3;
             animData[i] = min(animData[i], 1);
           }
           currentColor.r += (targetColor.r - currentColor.r) * 0.01;
           currentColor.g += (targetColor.g - currentColor.g) * 0.01;
           currentColor.b += (targetColor.b - currentColor.b) * 0.01;
           currentColor.r = min(max(currentColor.r,0),255);
           currentColor.g = min(max(currentColor.g,0),255);
           currentColor.b = min(max(currentColor.b,0),255);

           ctx.clearRect(0,0,1980,1080);

           // ËÉåÊôØ/„Éû„Çπ„ÇØ
           if (images.bg)   ctx.drawImage(images.bg, 0, 0);
           if (images.mask) ctx.drawImage(images.mask, 954, 99);

           // ÊôÇÂàªÔºàÊñú„ÇÅÔºâ
           ctx.fillStyle = '#97adbb';
           ctx.font = '32pt Impact';
           ctx.transform(1, 2.05 * (Math.PI / 180), 0, 1, 0, 0);
           const t = new Date();
           const hh = (t.getHours()<10?'0':'') + t.getHours();
           const mm = (t.getMinutes()<10?'0':'') + t.getMinutes();
           const ss = (t.getSeconds()<10?'0':'') + t.getSeconds();
           ctx.fillText(`${hh}:${mm}:${ss}`, 725, 318);
           ctx.resetTransform();

           // „Ç´„É¨„É≥„ÉÄ„ÉºÔºà„Éë„Éº„ÇπÔºâ
           ctx.transform(0.9645, 0, 0, 0.96, 967, 100);
           ctx.rotate(6 * (Math.PI / 180));
           ctx.drawImage(rili, 0, 0);
           ctx.resetTransform();

           // „Çπ„Éö„ÇØ„Éà„É©„É†Ëª∏
           ctx.transform(0.9645, 0, 9 * (Math.PI / 180), 1, 825, 160);
           ctx.rotate(7 * (Math.PI / 180));

           targetColor = {r:80, g:120, b:169};
           night = !(t.getHours() >= 6 && t.getHours() <= 18);
           if (night) targetColor = {r:255, g:75, b:80};

           ctx.fillStyle = 'rgba(0,0,0,0.5)';
           ctx.fillRect(-10, 320, 650, 2);

           ctx.fillStyle = toRgb(currentColor);
           for (let i=32;i<95;i++){
             ctx.fillRect(10*(i-32), 20+(300-300*animData[i]), 4, 300*animData[i]);
           }
           ctx.resetTransform();

           // ÂÖâÔºàoverlayÔºâ
           if (images.light) {
             ctx.globalCompositeOperation='overlay';
             ctx.drawImage(images.light, 971, 197);
             ctx.globalCompositeOperation='source-over';
           }

           // Á¥ôÂêπÈõ™/‰∫∫Áâ©
           if (images.caidai) ctx.drawImage(images.caidai, 949, 25);
           if (images.main)   ctx.drawImage(images.main, 1319, 345);

           // Â§úÈñìÂÖâ
           if (night && lightColor.a < 0.7) { lightColor.a = min(lightColor.a + 0.005, 0.7); }
           else if (!night)                 { lightColor.a = max(lightColor.a - 0.005, 0.0); }

           if (lightColor.a > 0) {
             ctx.globalCompositeOperation='hard-light';
             ctx.fillStyle = toRgba(lightColor);
             ctx.fillRect(0,0,1980,1080);
             ctx.globalCompositeOperation='source-over';
             if (images.phoneLight) {
               ctx.globalAlpha = lightColor.a / 0.7;
               ctx.drawImage(images.phoneLight, 860, 437);
               ctx.globalAlpha = 1;
             }
           }

           // „Çπ„ÇØ„É™„Éº„É≥ÔºàÂêàÊàêÊ∏à„ÅøÔºâ
           ctx.drawImage(screenImage, 0, 0);
           if (lightColor.a > 0 && images.screenLight) {
             ctx.globalAlpha = lightColor.a / 0.7;
             ctx.drawImage(images.screenLight, 0, 0);
             ctx.globalAlpha = 1;
           }

           // „Çπ„Éû„ÉõÊå®Êã∂
           let greeting = 'ÂáåÊô®Âï¶!';
           phoneText.forEach(v => { if (t.getHours() >= v.time) greeting = v.text; });
           ctx.fillStyle = '#fff';
           ctx.font = '31.02pt SimHei';
           ctx.transform(1.0911, -35*(Math.PI/180), 0, 0.5868, 1132.94, 564.07);
           ctx.rotate(56.5 * (Math.PI/180));
           ctx.textAlign='center';
           ctx.fillText(greeting, 135, 100);
           ctx.textAlign='start';
           ctx.resetTransform();

           // Âá∫ÂäõÔºàÂéüÊú¨È¢®„Çπ„Ç±„Éº„É´Ôºâ
           resizeLikeOriginal();
           displayCtx.drawImage(cvs, 0, 0, display.width, display.height);

           requestAnimationFrame(render);
         }

         drawRili();
         setInterval(drawRili, 3600000); // 1h
         window.addEventListener('resize', resizeLikeOriginal);
         resizeLikeOriginal();
         requestAnimationFrame(render);
         console.log('Fantasy render loop started');
       });
     }

     // „Çπ„É†„Éº„Ç∫„Çπ„ÇØ„É≠„Éº„É´ÔºàÊó¢Â≠ò„ÅÆ„Åæ„ÅæÔºâ
     document.querySelectorAll('a[href^="#"]').forEach(a=>{
       a.addEventListener('click', function(e){
         e.preventDefault();
         const t = document.querySelector(this.getAttribute('href'));
         if (t) t.scrollIntoView({behavior:'smooth'});
       });
     });
   })();
  </script>
</body>
</html>